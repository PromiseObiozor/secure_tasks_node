<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Your Tasks - SecureTasks (Secure)</title>
    <link rel="stylesheet" href="/styles.css" />
</head>

<body>
    <header>
        <% if (user) { %>
            Logged in as <%= user.email %> |
                <a href="/tasks">Tasks</a> |
                <a href="/tasks/new">New Task</a> |
                <a href="/logout">Logout</a>
                <% } else { %>
                    <a href="/register">Register</a> |
                    <a href="/login">Login</a>
                    <% } %>
    </header>

    <div class="page">
        <h1>Your Tasks</h1>

        <form method="GET" action="/tasks">
            <label>Search by title:</label>
            <input type="text" name="q" value="<%= q || '' %>" />
            <button type="submit">Search</button>
        </form>

        <% if (x && x.length> 0) { %>
            <p>Message: <%= x %>
            </p>
            <% } %>

                <hr />

                <h2>DOM input demo (secure)</h2>
                <p>Type a message and click "Show":</p>

                <input id="domInput" type="text" placeholder="Type something" />
                <button type="button" onclick="domShow()">Show</button>

                <div id="domOutput"></div>

                <script>
                    function domShow() {
                        var msg = document.getElementById("domInput").value;
                        // SECURE: use textContent
                        document.getElementById("domOutput").textContent = msg;
                    }
                </script>

                <hr />

                <h2>Task list</h2>

                <ul>
                    <% tasks.forEach(function (task) { %>
                        <li>
                            <strong>
                                <%= task.title %>
                            </strong>
                            <div>
                                <%= task.description %>
                            </div>
                            <small>Created at: <%= task.created_at %></small>
                        </li>
                        <% }); %>
                </ul>
    </div>
</body>

</html>